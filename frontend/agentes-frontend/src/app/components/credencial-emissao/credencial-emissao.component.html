<section class="credencial-emissao">
  <h2>Emiss√£o de Credencial</h2>

  <div *ngIf="erro" class="alert alert-danger">{{ erro }}</div>

  <div class="form-group">
    <label for="agente">Selecione o agente (ATIVO):</label>
    <select id="agente" class="form-select" [(ngModel)]="selecionadoId">
      <option [ngValue]="undefined">-- escolha --</option>
      <option *ngFor="let a of agentesAtivos" [ngValue]="a.id">{{ a.nomeCompleto }} ({{ a.cpf }})</option>
    </select>
  </div>

  <div class="mt-3 d-flex gap-2">
    <app-button type="primary" label="Emitir Credencial" [disabled]="!selecionadoId || loading" (clicked)="emitir()"></app-button>
    <app-button type="ghost" label="Recarregar" [disabled]="loading" (clicked)="carregarAgentesAtivos()"></app-button>
  </div>

  <div class="mt-4" *ngIf="ultimaCredencial">
    <div class="alert alert-success">
      Credencial emitida com sucesso para {{ ultimaCredencial?.nomeAgente }}.
      <div>QR URL: {{ ultimaCredencial?.qrCodeUrl }}</div>
    </div>
    <app-button type="danger" label="Baixar PDF" (clicked)="baixarPDF()"></app-button>
  </div>
</section>
